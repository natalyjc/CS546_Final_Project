<div class="course-detail-container">
  <h2 class="course-detail-title">{{course.title}}</h2>
  <div class="course-meta">
    <span><strong>Start:</strong> {{course.startDate}}</span>
    <span><strong>End:</strong> {{course.endDate}}</span>
  </div>

  <div class="course-notes">
    <strong>Notes:</strong><br />
    {{course.notes}}
  </div>

  <div>
    <h3>ğŸ”— Resources</h3>
    {{#if course.resources.length}}
      <ul>
        {{#each course.resources}}
          <li>
            <a href="{{this.link}}" target="_blank">{{this.title}}</a>
            <div class="course-actions">
              <form action="/courses/{{../course._id}}/resources/{{this.resourceId}}/edit" method="GET">
                <button class="submit-btn" type="submit">âœï¸ Edit</button>
              </form>
              <form action="/courses/{{../course._id}}/resources/{{this.resourceId}}/delete" method="POST">
                <button class="submit-btn delete-course-btn" type="submit">ğŸ—‘ Delete</button>
              </form>
            </div>
          </li>
        {{/each}}
      </ul>
    {{else}}
      <p>No resources yet.</p>
    {{/if}}
  </div>

  <div>
  <h3>ğŸ“ Assignments</h3>
  {{#if course.assignments.length}}
    <ul>
      {{#each course.assignments}}
        {{#unless this.isCompleted}}
        <!-- Incomplete assignments -->
        <li>
          <strong>{{this.title}}</strong> â€” due {{this.dueDate}}<br />
          <em>{{this.description}}</em><br />
          <div class="assignment-actions">
            <form action="/courses/{{../course._id}}/assignments/{{this.assignmentId}}/complete" method="POST">
              <button class="submit-btn" type="submit">ğŸ“¬ Submit</button>
            </form>
            <form action="/courses/{{../course._id}}/assignments/{{this.assignmentId}}/edit" method="GET">
              <button class="submit-btn" type="submit">âœï¸ Edit</button>
            </form>
            <form action="/courses/{{../course._id}}/assignments/{{this.assignmentId}}/delete" method="POST">
              <button class="submit-btn delete-course-btn" type="submit">ğŸ—‘ Delete</button>
            </form>
          </div>
        </li>
        {{/unless}}
      {{/each}}
    </ul>

    <!-- Dropdown for completed assignments -->
    <details style="margin-top: 1rem;">
      <summary style="cursor: pointer; font-weight: bold;"> Show Completed Assignments</summary>
      <ul>
        {{#each course.assignments}}
          {{#if this.isCompleted}}
          <li>
            <strong>{{this.title}}</strong> â€” completed on {{this.completedDate}}<br />
            <em>{{this.description}}</em>
          </li>
          {{/if}}
        {{/each}}
      </ul>
    </details>
  {{else}}
    <p>No assignments yet.</p>
  {{/if}}
  
  <!-- Course Recommendations -->
  <div class="course-recommendations" style="margin-top: 2rem;">
    <h3>ğŸ¥ Recommended Videos</h3>
    {{#if recommendations.length}}
      <ul style="list-style: none; padding: 0;">
        {{#each recommendations}}
          <li style="margin-bottom: 1rem;">
            <a href="{{this.link}}" target="_blank" style="display: flex; align-items: center; gap: 1rem;">
              <img src="{{this.thumbnail}}" alt="{{this.title}}" style="width: 120px; border-radius: 8px;" />
              <span>{{this.title}}</span>
            </a>
          </li>
        {{/each}}
      </ul>
    {{else}}
      <p>No recommendations available.</p>
    {{/if}}
  </div>
</div>

  <div class="course-actions">
    <button id="toggleAssignmentForm" class="submit-btn">â• Add Assignment</button>
    <button id="toggleResourceForm" class="submit-btn">â• Add Resource</button>
  </div>

  <div id="assignmentFormContainer" style="display:none;">
    <form action="/courses/{{course._id}}/assignments" method="POST" class="form-card">
      <h3>Add Assignment</h3>
      <div class="form-group"><label>Title</label><input type="text" name="title" required></div>
      <div class="form-group"><label>Description</label><textarea name="description" required></textarea></div>
      <div class="form-group"><label>Due Date</label><input type="datetime-local" name="dueDate" required></div>
      <button type="submit" class="submit-btn">Add</button>
    </form>
  </div>

  <div id="resourceFormContainer" style="display:none;">
    <form action="/courses/{{course._id}}/resources" method="POST" class="form-card">
      <h3>Add Resource</h3>
      <div class="form-group"><label>Title</label><input type="text" name="title" required></div>
      <div class="form-group"><label>Link</label><input type="url" name="link" required></div>
      <button type="submit" class="submit-btn">Add</button>
    </form>
  </div>

  <a href="/dashboard" class="btn-back-top">â¬… Back to Dashboard</a>
</div>

{{!-- <script>
  document.getElementById('toggleAssignmentForm').onclick = () => {
    const form = document.getElementById('assignmentFormContainer');
    form.style.display = form.style.display === 'none' ? 'block' : 'none';
  };

  document.getElementById('toggleResourceForm').onclick = () => {
    const form = document.getElementById('resourceFormContainer');
    form.style.display = form.style.display === 'none' ? 'block' : 'none';
  };
</script> --}}

<script src="/js/validateCourse.js"></script>
<script src="/js/recommendations.js"></script>